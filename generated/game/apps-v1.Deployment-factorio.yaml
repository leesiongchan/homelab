apiVersion: apps/v1
kind: Deployment
metadata:
  name: factorio
  namespace: game
spec:
  minReadySeconds: 10
  replicas: 1
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      name: factorio
  template:
    metadata:
      annotations:
        factorio-config-hash: fb6b615e4e1cce58e5b8a0c9fe85f3d4
      labels:
        name: factorio
    spec:
      containers:
      - image: factoriotools/factorio:2.0.47
        imagePullPolicy: IfNotPresent
        name: factorio
        ports:
        - containerPort: 27015
          name: tcp
        - containerPort: 34197
          name: udp
          protocol: UDP
        securityContext:
          runAsGroup: 845
          runAsUser: 845
        volumeMounts:
        - mountPath: /factorio/config
          name: config
        - mountPath: /factorio/config/server-settings.json
          name: factorio-config
          subPath: server-settings.json
      securityContext:
        fsGroup: 845
      volumes:
      - emptyDir: {}
        name: config
      - configMap:
          name: factorio-config
        name: factorio-config
